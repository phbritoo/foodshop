CREATE DATABASE SHOPFOOD; 

CREATE TABLE USUARIO(
ID  INT PRIMARY KEY IDENTITY(1,1),
CPF VARCHAR(11) NOT NULL UNIQUE, 
NOME VARCHAR(200) NOT NULL,
DATANASCIMENTO DATE NOT NULL,
ENDERECO VARCHAR(200) NOT NULL,
TELEFONE VARCHAR(11),
ISADM CHAR(1) CHECK (ISADM = 'S' OR ISADM = 'N')
)

CREATE TABLE CARTAOCREDITO(
ID INT PRIMARY KEY IDENTITY(1,1),
NUMERO VARCHAR(16) NOT NULL,
BANDEIRA VARCHAR(15) NOT NULL,
DATAVALIDADE DATE NOT NULL,
CODIGOSEGURANCA VARCHAR(3) NOT NULL
)

CREATE TABLE USUARIO_CARTAOCREDITO(
USUARIOID INT NOT NULL REFERENCES USUARIO(ID),
CARTAOCREDITOID INT NOT NULL REFERENCES CARTAOCREDITO(ID)
)

CREATE TABLE CARRINHO(
NUMERO INT PRIMARY KEY IDENTITY(1,1),
CARTAOCREDITOID INT NOT NULL REFERENCES CARTAOCREDITO(ID),
USUARIOID INT  NOT NULL REFERENCES USUARIO(ID)
)

CREATE TABLE NOTAFISCAL(
NUMERO INT PRIMARY KEY IDENTITY(1,1),
DATAEMISSAO DATE NOT NULL,
PRECOTOTAL DECIMAL(14,2) NOT NULL,
QUANTIDADEPRODUTOS INT NOT NULL,
NUMEROCARRINHO INT REFERENCES CARRINHO(NUMERO)
)

CREATE TABLE PRODUTO(
ID INT PRIMARY KEY IDENTITY(1,1)
CODIGOBARRA VARCHAR(50) NOT NULL,
NOME VARCHAR(100) NOT NULL,
DESCRICAO VARCHAR(100) NOT NULL,
MARCA VARCHAR(200)
)

CREATE TABLE LOJA(
CNPJ INT PRIMARY KEY ,
RAZAOSOCIAL VARCHAR(200) NOT NULL,
NOMEFANTASIA VARCHAR(100)
)

CREATE TABLE PRODUTO_LOJA(
ID INT PRIMARY KEY IDENTITY(1,1),
CODIGOBARRAS INT NOT NULL REFERENCES PRODUTO(CODIGOBARRAS),
CNPJ INT NOT NULL REFERENCES LOJA(CNPJ),
VALOR DECIMAL(14,2) NOT NULL
)

CREATE TABLE CARRINHO_PRODUTO_LOJA(
NUMEROCARRINHO INT NOT NULL REFERENCES CARRINHO(NUMERO),
PRODUTO_LOJAID INT NOT NULL REFERENCES PRODUTO_LOJA(ID),
VALOR DECIMAL(14,2) NOT NULL ,
QUANTIDADE INT NOT NULL
)
